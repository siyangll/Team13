<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Software Requirements Specification</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
            background-color: #f4f4f4;
        }
        .header {
            background: linear-gradient(135deg, #007ACC, #4CAF50);
            color: white;
            padding: 20px 0;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        .content {
            max-width: 900px;
            margin: 20px auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .content h2 {
            color: #4CAF50; /* Green title color */
            margin-bottom: 15px;
        }
        .content ul {
            margin: 10px 0 20px 20px;
            padding-left: 20px;
        }
        .content ul li {
            margin: 10px 0;
        }
        img {
            display: block;
            margin: 20px auto;
            width: 90%;
            max-width: 800px;
            border: 2px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .footer {
            background: linear-gradient(135deg, #4CAF50, #007ACC);
            color: white;
            padding: 20px 0;
            text-align: center;
            font-size: 1.2em;
            margin-top: 30px;
        }
        a {
            display: block;
            margin-top: 20px;
            text-align: center;
            color: #007ACC;
            font-size: 1.2em;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Software Requirements Specification</h1>
    </div>

    <div class="content">
        <h2>SRS 01 - Water level shall be measured using capacitive sensing (FDC1004) every 5 seconds with ±5ml accuracy</h2>
        <p><strong>Status:</strong> Achieved</p>
        <ul>
            <li>The water level is monitored every 5 seconds using a pressure sensor (FSR406) as an alternative to capacitive sensing.</li>
            <li>ADC readings are used to calculate the water level with a ±5ml accuracy through linear interpolation.</li>
        </ul>
        <p><strong>Code snippet:</strong></p>
        <pre>
uint16_t pressureReading = ADC_Read(Pressure_PIN);
float currentVolume = getVolumeFromAdc(pressureReading);
waterIntakeTotal += lastVolume - currentVolume;
        </pre>
        <p><strong>Screenshot:</strong></p>
        <img src="mvp-waterintake.png" alt="Water Intake Screenshot">
        <p>The screenshot shows the ADC value of the measurement, the real-time update of the water volume, and the total amount of water intake.</p>
        <p><strong>Data collection process:</strong></p>
        <ul>
            <li>FSR406 sensor outputs analog signals, converted to digital using ADC.</li>
            <li>Sampling frequency is set to once every 5 seconds.</li>
        </ul>
        <p><strong>Result analysis:</strong></p>
        <ul>
            <li>Measurements consistently stayed within ±5ml deviation, meeting accuracy requirements.</li>
        </ul>
    </div>

    <div class="content">
        <h2>SRS 02 - TDS measurements shall be performed on demand, with readings completed within 5 seconds</h2>
        <p><strong>Status:</strong> Achieved</p>
        <ul>
            <li>TDS (Total Dissolved Solids) measurements are triggered on-demand using the SEN0244 sensor.</li>
            <li>Data is processed with a temperature compensation formula, completing within 4.5 seconds.</li>
        </ul>
        <p><strong>Code snippet:</strong></p>
        <pre>
float tdsValue = getTDS(temperature);
lcd_display("TDS Value", tdsValue);
        </pre>
        <p><strong>Result analysis:</strong></p>
        <ul>
            <li>The average measurement time is 4.5 seconds, meeting the requirement of under 5 seconds.</li>
        </ul>
    </div>

    <div class="content">
        <h2>SRS 03 - Heart rate shall be measured on-demand when the bottle is held, with readings completed within 15 seconds</h2>
        <p><strong>Status:</strong> Achieved</p>
        <ul>
            <li>MAX30102 sensor measures heart rate when the bottle is held. Data is processed and displayed within 12 seconds.</li>
        </ul>
        <p><strong>Code snippet:</strong></p>
        <pre>
uint16_t pulseReading = ADC_Read(PULSE_PIN);
process_pulse(pulseReading);
        </pre>
        <p><strong>Result analysis:</strong></p>
        <ul>
            <li>The average heart rate measurement time is 12 seconds, fulfilling the requirement of completion within 15 seconds.</li>
        </ul>
    </div>

    <div class="content">
        <h2>SRS 04 - The system shall perform wireless communication using the ESP32 Wi-Fi module on the Blynk platform</h2>
        <p><strong>Status:</strong> Achieved</p>
        <ul>
            <li>ESP32 module uploads real-time data (heart rate, TDS, water intake) to the Blynk platform via Wi-Fi.</li>
        </ul>
        <p><strong>Code snippet:</strong></p>
        <pre>
Blynk.virtualWrite(V0_BPM, bpm);
Blynk.virtualWrite(V1_WATER_INTAKE, waterintake);
Blynk.virtualWrite(V3_TDS, tdsValue);
        </pre>
        <p><strong>Screenshot:</strong></p>
        <img src="MVP_Bylnk.png" alt="Blynk Screenshot">
    </div>

    <div class="content">
        <h2>SRS 05 - The system shall maintain daily water intake records and sync with the mobile app every 15 minutes when connected</h2>
        <p><strong>Status:</strong> Partially achieved</p>
        <ul>
            <li>Daily water intake records are logged and updated locally.</li>
            <li>Data synchronization with the cloud is implemented, but storing time-series data on the cloud is still under optimization.</li>
        </ul>
        <p><strong>Reason for delay:</strong></p>
        <ul>
            <li>Optimization of cloud storage for historical data is pending.</li>
        </ul>
    </div>

    <div class="content">
        <h2>SRS 06 - Hydration reminders shall be triggered on the buzzer, displayed on the LCD, and sent through the UI if no water consumption is detected for 2 hours during active hours</h2>
        <p><strong>Status:</strong> Partially achieved</p>
        <p><strong>Current implementation:</strong></p>
        <ul>
            <li>Hydration reminders are successfully displayed on the LCD and sent to the Blynk app when no water consumption is detected for 2 hours.</li>
            <li>The buzzer is not yet configured to sound for the reminder.</li>
        </ul>
        <p><strong>Pending work:</strong></p>
        <ul>
            <li>Integrate the buzzer to sound a short alert along with the LCD and app reminders.</li>
        </ul>
        <p><strong>Updated Code Snippet:</strong></p>
        <pre>
if (current_time - last_change_time >= 7200000) {
    progmem_to_ram(buffer, str_drink);
    LCD_drawString(5, 100, buffer, RED, BLACK);
    snprintf(reminder, sizeof(reminder), "%s", buffer);
}

Blynk.virtualWrite(V2_DRINK, "Reminder: Drink Water");
        </pre>
        <p><strong>Next Steps:</strong></p>
        <ul>
            <li>Implement the <code>trigger_buzzer()</code> function to activate the buzzer when the hydration reminder is triggered.</li>
        </ul>
    </div>

    <div class="content">
        <h2>SRS 07 - Display shall update every 2 seconds with the current hydration level, water quality, and heart rate measurement when prompted</h2>
        <p><strong>Status:</strong> Achieved</p>
        <ul>
            <li>The LCD updates every 2 seconds with the current hydration level, TDS, and heart rate when prompted.</li>
        </ul>
        <p><strong>Code snippet:</strong></p>
        <pre>
progmem_to_ram(buffer, str_heart_rate);
LCD_drawString(5, 20, buffer, WHITE, BLACK);

progmem_to_ram(buffer, str_water_intake);
LCD_drawString(5, 40, buffer, WHITE, BLACK);

progmem_to_ram(buffer, str_water_quality);
LCD_drawString(5, 60, buffer, WHITE, BLACK);
        </pre>
    </div>

    <div class="content">
        <h2>SRS 08 - Buzzer shall sound for five seconds to alert the user if the user stops drinking water for 2 hours</h2>
        <p><strong>Status:</strong> Partially achieved</p>
        <ul>
            <li>If no water consumption is detected for 2 hours, the buzzer sounds for 5 seconds to alert the user.</li>
        </ul>
        <p><strong>Code snippet:</strong></p>
        <pre>
// Trigger drinking reminder if water level doesn't change for a long time
if (current_time - last_change_time >= 3000) {
    progmem_to_ram(buffer, str_drink);
    LCD_drawString(5, 100, buffer, RED, BLACK);
    snprintf(reminder, sizeof(reminder), "%s", buffer);
}
        </pre>
        <p><strong>Pending work:</strong></p>
        <ul>
            <li>The buzzer is not yet configured to sound for the reminder.</li>
        </ul>
        <p><strong>Next Steps:</strong></p>
        <ul>
            <li>Implement the <code>trigger_buzzer()</code> function to activate the buzzer when the hydration reminder is triggered.</li>
        </ul>
    </div>

    <a href="index.html">Back to Main Page</a>

    <div class="footer">
        Thanks for your visiting! Copyright belongs to Team13.
    </div>
</body>
</html>
